<!DOCTYPE html>
<html>
<head>
    <title>Women Safety Route Finder</title>

    <link rel="stylesheet"
    href="https://unpkg.com/leaflet/dist/leaflet.css"/>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <style>
        body { font-family: Arial; text-align: center; }
        #map { height: 500px; width: 90%; margin: auto; }
        select, button { padding:10px; margin:5px; }
    </style>
</head>
<body>

<h1>Women Safety Route Finder</h1>
<p>Click map to select Start and Destination</p>

<select id="time">
<option value="day">Day</option>
<option value="night">Night</option>
</select>

<select id="companion">
<option value="alone">Alone</option>
<option value="female">With Female Friend</option>
<option value="male">With Male Friend</option>
</select>

<button onclick="findRoute()">Find Safest Route</button>

<h3 id="result"></h3>

<div id="map"></div>

<script>
let map = L.map('map').setView([19.9975, 73.7898], 13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')
.addTo(map);

let points = [];
let routeLayer;

map.on('click', function(e) {
    if (points.length < 2) {
        points.push([e.latlng.lng, e.latlng.lat]);
        L.marker(e.latlng).addTo(map);
    }
});

async function findRoute() {

    if (points.length < 2) {
        alert("Select start and destination first.");
        return;
    }

    let time = document.getElementById("time").value;
    let companion = document.getElementById("companion").value;

    let response = await fetch("YOUR_RENDER_BACKEND_URL/route", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            start: points[0].join(","),
            end: points[1].join(","),
            time: time,
            companion: companion
        })
    });

    let data = await response.json();

    if (routeLayer) map.removeLayer(routeLayer);

    routeLayer = L.geoJSON(data.geometry, {
        style: {color: "green", weight: 5}
    }).addTo(map);

    map.fitBounds(routeLayer.getBounds());

    document.getElementById("result").innerText =
        "Safety Score: " + data.score +
        " | Distance: " + (data.distance/1000).toFixed(2) + " km";
}
</script>

</body>
</html>
